<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>管理者 - チェックアウト</title>
</head>
<body>
<h1>チェックアウト</h1>
<video id="video" width="400" height="300" autoplay></video>

<script src="https://unpkg.com/html5-qrcode@2.3.8/minified/html5-qrcode.min.js"></script>
<script>
const videoElem = document.getElementById('video');
navigator.mediaDevices.getUserMedia({video:true}).then(stream=>{
  videoElem.srcObject = stream;
});

const html5QrCode = new Html5Qrcode("video");
html5QrCode.start({ facingMode: "environment" }, { fps: 10, qrbox: 250 },
  async (decodedText, decodedResult)=>{
    const ticket = parseInt(decodedText);
    await fetch('/admin/checkout',{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({ticket})
    });
  },
  (errorMessage)=>{}
);
</script>
</body>
</html>
